<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>LanHub - Script Library</title>
<link rel="preconnect" href="https://thumbnails.roblox.com">
<style>
  :root{
    --bg1:#0b0010; --bg2:#190024; --accent:#a855f7;
    --card:#1a0028; --muted:#bbb;
  }
  *{box-sizing:border-box;margin:0;padding:0;font-family:Montserrat,system-ui,Arial;}
  body{
    min-height:100vh;
    background:linear-gradient(160deg,var(--bg1),var(--bg2));
    color:#fff; display:flex;flex-direction:column;align-items:center;padding:20px;
  }
  header{width:100%;max-width:720px;padding:6px 10px;display:flex;flex-direction:column;gap:12px;align-items:center}
  h1{color:#c293ff;text-shadow:0 0 12px var(--accent);font-size:1.6rem}
  .search{
    width:100%;max-width:480px;display:flex;gap:8px;
  }
  .search input{
    flex:1;padding:12px 14px;border-radius:14px;border:none;background:rgba(50,0,90,0.7);color:#fff;
    outline: none; box-shadow:0 0 10px rgba(168,85,247,0.08);
  }
  main{width:100%;max-width:480px;margin-top:8px;display:flex;flex-direction:column;gap:14px}
  .card{
    background:rgba(25,0,40,0.85);border:1px solid rgba(168,85,247,0.18);
    border-radius:16px;padding:12px;backdrop-filter:blur(8px);display:flex;flex-direction:column;gap:8px;
    box-shadow:0 6px 18px rgba(0,0,0,0.45);
  }
  .thumb{width:100%;height:170px;border-radius:10px;object-fit:cover;background:#0f0b12;opacity:0;transition:opacity .35s}
  .thumb.loaded{opacity:1}
  h2{color:#e7d2ff;font-size:1.05rem}
  .meta{color:var(--muted);font-size:0.88rem}
  .actions{display:flex;gap:8px;margin-top:6px}
  .btn{flex:1;padding:9px;border-radius:10px;border:none;background:#5f21a1;color:#fff;font-weight:600;cursor:pointer;transition:all .14s}
  .btn:hover{transform:translateY(-3px);box-shadow:0 6px 18px rgba(147,51,234,0.18)}
  .hidden{display:none !important}
  footer{margin-top:22px;color:#aaa;font-size:0.88rem;text-align:center}
  /* toast */
  .toast{position:fixed;right:18px;bottom:18px;background:rgba(0,0,0,0.7);padding:10px 14px;border-radius:10px;color:#fff;box-shadow:0 6px 18px rgba(0,0,0,0.6)}
  /* responsive */
  @media(min-width:900px){body{padding:30px}header{max-width:1000px}main{max-width:720px}}
</style>
</head>
<body>
<header>
  <h1>LanHub Script Library</h1>
  <div class="search">
    <input id="searchInput" type="search" placeholder="ðŸ” Search scripts (type game name) â€” hit ESC to clear">
  </div>
</header>

<main id="cardContainer" aria-live="polite"></main>

<footer>Â© 2025 LanHub â€¢ All Rights Reserved.</footer>

<!-- toast container -->
<div id="toastRoot" style="pointer-events:none"></div>

<script>
/*
  Clean, single-file script library:
  - thumbnails fetched from Roblox Game Icons API using gameId
  - no duplicate UI creation
  - debounce search, ESC to clear
  - copy/raw/download available per card
  - fallback thumbnail
  - toast notifications (not alert)
*/

/* --- Data: EDIT THIS to add scripts --- 
   gameId: Roblox universeId / place's universe id (number).
   name, date, code.
*/
const scripts = [
  {
    name: "99 Night In The Forest",
    date: "Nov 2025",
    gameId: 3678761576,
    code: `-- LanHub Script: 99 Night In The Forest
print("LanHub Forest Script Loaded!")`
  },
  {
    name: "Dead Rails",
    date: "Oct 2025",
    gameId: 14658443702,
    code: `-- LanHub Script: Dead Rails
print("LanHub Dead Rails Script Loaded!")`
  }
];

/* --- helpers --- */
const cardContainer = document.getElementById('cardContainer');
const toastRoot = document.getElementById('toastRoot');

function toast(msg, time=1500){
  const el = document.createElement('div');
  el.className = 'toast';
  el.textContent = msg;
  toastRoot.appendChild(el);
  setTimeout(()=>{ el.style.opacity='0.0'; el.style.transform='translateY(6px)'; }, time-250);
  setTimeout(()=>el.remove(), time);
}

/* Build UI once */
function buildCards(){
  cardContainer.innerHTML = ''; // ensure clean
  scripts.forEach((s,i) => {
    const card = document.createElement('article');
    card.className = 'card';
    card.setAttribute('data-name', s.name.toLowerCase());

    // image with fallback placeholder first
    const img = document.createElement('img');
    img.className = 'thumb';
    img.alt = s.name + " thumbnail";
    img.id = 'thumb-' + i;
    img.src = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="420" height="420"><rect width="100%" height="100%" fill="%230f0710"/></svg>';
    // append then load actual
    card.appendChild(img);

    const h = document.createElement('h2'); h.textContent = s.name; card.appendChild(h);
    const m = document.createElement('div'); m.className='meta'; m.textContent = 'Created: ' + s.date; card.appendChild(m);

    const actions = document.createElement('div'); actions.className = 'actions';
    const rawBtn = document.createElement('button'); rawBtn.className='btn'; rawBtn.textContent='Raw';
    rawBtn.onclick = ()=> openRaw(i);
    const copyBtn = document.createElement('button'); copyBtn.className='btn'; copyBtn.textContent='Copy';
    copyBtn.onclick = ()=> copyScript(i);
    const dlBtn = document.createElement('button'); dlBtn.className='btn'; dlBtn.textContent='Download';
    dlBtn.onclick = ()=> downloadScript(i);

    actions.appendChild(rawBtn); actions.appendChild(copyBtn); actions.appendChild(dlBtn);
    card.appendChild(actions);
    cardContainer.appendChild(card);

    // Fetch thumbnail via Roblox API (games icons). If fails -> fallback image.
    if (s.gameId){
      fetch(`https://thumbnails.roblox.com/v1/games/icons?universeIds=${encodeURIComponent(s.gameId)}&size=420x420&format=Png`)
        .then(r=>r.json())
        .then(data=>{
          if (data && data.data && data.data[0] && data.data[0].imageUrl){
            img.src = data.data[0].imageUrl;
          } else {
            img.src = 'https://i.ibb.co/3zM4G2L/lanhub-default.png';
          }
        })
        .catch(()=>{ img.src = 'https://i.ibb.co/3zM4G2L/lanhub-default.png' })
        .finally(()=> img.classList.add('loaded'));
    } else {
      img.src = 'https://i.ibb.co/3zM4G2L/lanhub-default.png';
      img.classList.add('loaded');
    }
  });
}

/* search with debounce */
let searchTimer = null;
const searchInput = document.getElementById('searchInput');
function filterScripts(){
  clearTimeout(searchTimer);
  searchTimer = setTimeout(()=>{
    const q = (searchInput.value||'').trim().toLowerCase();
    document.querySelectorAll('.card').forEach(card=>{
      const name = card.getAttribute('data-name') || '';
      card.classList.toggle('hidden', q !== '' && !name.includes(q));
    });
  }, 120);
}
searchInput.addEventListener('input', filterScripts);
searchInput.addEventListener('keydown', (e)=>{
  if(e.key === 'Escape'){ searchInput.value=''; filterScripts(); toast('Search cleared'); }
});

/* Raw / Copy / Download functions */
function openRaw(index){
  const code = scripts[index].code || '-- no code';
  const w = window.open('','_blank','noopener');
  // sanitized pre
  w.document.write(`<pre style="white-space:pre-wrap;color:#fff;background:#0a0012;padding:16px;font-family:monospace;border-radius:8px;">${escapeHtml(code)}</pre>`);
  w.document.title = scripts[index].name + ' - Raw';
  w.document.close();
}
function copyScript(index){
  const txt = scripts[index].code || '';
  navigator.clipboard.writeText(txt).then(()=>{ toast('Script copied to clipboard'); })
  .catch(()=>{ toast('Copy failed') });
}
function downloadScript(index){
  const name = scripts[index].name.replace(/\s+/g,'_') || 'script';
  const blob = new Blob([scripts[index].code || ''], {type:'text/plain'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = name + '.txt';
  document.body.appendChild(a); a.click(); a.remove();
  toast('Download started');
}

function escapeHtml(str){ return String(str).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

/* Prevent duplicate UI on re-insert: build only once */
if(!window.__LanHubBuilt){
  buildCards();
  window.__LanHubBuilt = true;
} else {
  // if hot-reload, ensure no duplicates and rebuild
  document.getElementById('cardContainer').innerHTML='';
  buildCards();
}

/* debug helper for console if thumbnail issues */
console.info('LanHub: built cards:', scripts.length);

/* Optional: expose functions for dev console */
window.LanHub = { scripts, rebuild: buildCards, copyScript, openRaw, downloadScript };

</script>
</body>
</html>
