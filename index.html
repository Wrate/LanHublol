<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LanHub - Script Library</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: "Montserrat", sans-serif; }
    body {
      background: linear-gradient(160deg, #0b0010, #190024);
      color: #fff; display: flex; flex-direction: column;
      align-items: center; min-height: 100vh; padding: 20px 10px;
    }
    h1 {
      font-size: 1.7rem; color: #c293ff; margin-bottom: 15px;
      text-shadow: 0 0 10px #a855f7; text-align: center;
    }
    #popupOverlay {
      position: fixed; inset: 0; background: rgba(0,0,0,0.7);
      display: none; justify-content: center; align-items: center; z-index: 999;
    }
    #popupBox {
      background: #1a0028; padding: 22px; border-radius: 16px; width: 90%;
      max-width: 350px; border: 1px solid #9333ea; box-shadow: 0 0 15px #9333ea;
      text-align: center;
    }
    .popup-btns button {
      width: 100%; padding: 11px; margin: 6px 0; border-radius: 10px;
      border: none; background: #6b21a8; color: white; cursor: pointer; font-weight: bold;
    }
    .cancelBtn { background: #3a004f !important; }
    .search-container { width: 100%; max-width: 400px; margin-bottom: 20px; }
    .search-container input {
      width: 100%; padding: 12px 15px; border-radius: 14px;
      background: rgba(50, 0, 90, 0.7); color: #fff;
    }
    .card-container {
      width: 100%; max-width: 450px; display: flex;
      flex-direction: column; gap: 16px;
    }
    .card {
      background: rgba(25, 0, 40, 0.8); border: 1px solid rgba(168,85,247,0.3);
      border-radius: 20px; padding: 15px; display: flex; flex-direction: column;
      backdrop-filter: blur(10px);
    }
    .beta-thumb {
      width: 100%; height: 180px; border-radius: 12px; margin-bottom: 10px;
      background: linear-gradient(135deg,#3a0060,#6b21a8); display: flex; justify-content: center;
      align-items: center; font-size: 1.5rem; color: #d6b3ff;
    }
    .buttons { display: flex; justify-content: space-between; gap: 8px; }
    button {
      flex: 1; background: #6b21a8; padding: 10px; border-radius: 10px;
      color: white; font-weight: bold; border: none; cursor: pointer;
    }
    footer { margin-top: 25px; color: #aaa; text-align: center; }
  </style>
</head>

<body>

<h1>LanHub Script Library</h1>

<div id="popupOverlay">
  <div id="popupBox">
    <h3>Choose Unlock Method</h3>
    <div class="popup-btns">
      <button onclick="redirectUnlock()">Unlock</button>
      <button class="cancelBtn" onclick="closePopup()">Cancel</button>
    </div>
  </div>
</div>

<div class="search-container">
  <input id="searchInput" type="text" placeholder="üîç Search scripts..." oninput="filterScripts()">
</div>

<div class="card-container" id="cardContainer"></div>

<footer>
  ¬© 2025 <strong>LanHub</strong> ‚Äî All Rights Reserved.<br>
  <span style="font-size:0.8rem;">Designed by LanHubDev</span>
</footer>

<script>

let pendingId = "";
let pendingAction = "";

const scriptsData = [
  {
    id: "entrechedww1",
    name: "Entrenched WW1",
    created: "Oct 2025",
    category: "Shooter",

    unlock: "https://linkvertise.com/1321138/ww1unlock",   // üî• LINKVERTISE KHUSUS

    gameLink: "https://www.roblox.com/games/10157613626/",
    script: `-- WW1 Script
loadstring(game:HttpGet("https://raw.githubusercontent.com/Wrate/Entrenched-Ww1/refs/heads/main/Main.loader"))()`
  },

  {
    id: "beakgun",
    name: "Beak Shooter",
    created: "Nov 2025",
    category: "Shooter",

    unlock: "https://linkvertise.com/1321138/beakunlocks", // üî• LINKVERTISE KHUSUS

    gameLink: "https://www.roblox.com/games/16898830773/",
    script: `print("LanHub Beak Script Loaded!")`
  },
];

const container = document.getElementById("cardContainer");

function renderCards() {
  container.innerHTML = "";
  scriptsData.forEach(data => {
    const card = document.createElement("div");
    card.className = "card";

    card.innerHTML = `
      <div class="beta-thumb">BETA</div>
      <h2>${data.name}</h2>
      <p class="date">Created: ${data.created} | Category: ${data.category}</p>

      <div class="buttons">
        <button onclick="openPopup('${data.id}','raw')">Raw</button>
        <button onclick="openPopup('${data.id}','copy')">Copy</button>
        <button onclick="window.open('${data.gameLink}','_blank')">Game</button>
      </div>
    `;

    container.appendChild(card);
  });
}

function filterScripts() {
  const val = document.getElementById("searchInput").value.toLowerCase();
  const cards = container.querySelectorAll(".card");

  cards.forEach((card, index) => {
    const name = scriptsData[index].name.toLowerCase();
    card.style.display = name.includes(val) ? "flex" : "none";
  });
}

function openPopup(id, action) {
  pendingId = id;
  pendingAction = action;
  document.getElementById("popupOverlay").style.display = "flex";
}

function closePopup() {
  document.getElementById("popupOverlay").style.display = "none";
}

function redirectUnlock() {
  const d = scriptsData.find(x => x.id === pendingId);

  // buka linkvertise milik script itu
  window.open(d.unlock, "_blank");

  closePopup();

  // Setelah user selesai unlock ‚Üí otomatis buka hasilnya
  setTimeout(() => {
    if (pendingAction === "raw") showRaw(d);
    if (pendingAction === "copy") copyScript(d);
  }, 1800);
}

function showRaw(d) {
  const w = window.open("", "_blank");
  w.document.write(`<pre>${d.script}</pre>`);
}

function copyScript(d) {
  navigator.clipboard.writeText(d.script);
  alert("Copied!");
}

renderCards();

</script>

</body>
</html>st s = new Set();
  scriptsData.forEach(x=>{
    if(x.category) s.add(x.category);
  });
  return Array.from(s).sort();
}

/* populate category selectors */
function setupCategoryFilters(){
  const cats = uniqueCategories();
  categoryFilter.innerHTML = `<option value="">All categories</option>` + cats.map(c=>`<option value="${c}">${c}</option>`).join("");
  sideCategory.innerHTML = `<option value="">All</option>` + cats.map(c=>`<option value="${c}">${c}</option>`).join("");
}
setupCategoryFilters();

function renderCards(){
  cardList.innerHTML = "";
  let list = Array.from(scriptsData);

  // sorting
  const sb = sortBy.value;
  if(sb === "name") list.sort((a,b)=>a.name.localeCompare(b.name));
  else list.sort((a,b)=> (new Date(b.created).getTime() || 0) - (new Date(a.created).getTime() || 0));

  // render
  list.forEach(data=>{
    const r = document.createElement("div");
    r.className = "card";
    r.setAttribute("data-name", data.name.toLowerCase());
    r.setAttribute("data-category", (data.category||"").toLowerCase());

    const thumbUrl = buildThumbUrl(data);
    const thumbHtml = thumbUrl ? `<img src="${thumbUrl}" alt="${escapeHtml(data.name)}">` : `<div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;color:#f1d9ff;font-weight:700">BETA</div>`;

    r.innerHTML = `
      <div class="thumb">${thumbHtml}</div>
      <div class="card-content">
        <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:10px">
          <div>
            <h2>${escapeHtml(data.name)}</h2>
            <div class="meta">Created: ${escapeHtml(data.created)} &nbsp;|&nbsp; Category: ${escapeHtml(data.category || "Uncategorized")}</div>
          </div>
          <div style="text-align:right">
            <div class="beta-badge">BETA</div>
          </div>
        </div>

        <div class="tags" aria-hidden="true">
          <div class="tag">${escapeHtml(data.category || "N/A")}</div>
        </div>

        <div class="actions">
          <button class="btn small" onclick="handleAction('raw','${data.id}', this)">Raw</button>
          <button class="btn small secondary" onclick="handleAction('copy','${data.id}', this)">Copy</button>
          <button class="btn small secondary" onclick="handleAction('download','${data.id}', this)">Download</button>
          <button class="btn small" style="min-width:62px" onclick="openGame('${encodeURIComponent(data.gameLink||getGameId(data)||"")}')">Game</button>
        </div>
      </div>
    `;
    cardList.appendChild(r);
  });
}
renderCards();

/* -------------------------
   Filtering / Search
------------------------- */
function filterScripts(){
  const q = (document.getElementById("searchInput").value||"").toLowerCase().trim();
  const cat = categoryFilter.value;
  const cards = cardList.querySelectorAll(".card");
  let visible = 0;
  cards.forEach(card=>{
    const name = card.getAttribute("data-name")||"";
    const c = card.getAttribute("data-category")||"";
    const matchQ = q==="" || name.includes(q) || c.includes(q);
    const matchC = !cat || c === cat.toLowerCase();
    card.style.display = (matchQ && matchC) ? "flex" : "none";
    if(matchQ && matchC) visible++;
  });
  showNoResults(visible===0);
}
function filterBySideCategory(){
  const v = sideCategory.value;
  categoryFilter.value = v;
  filterScripts();
}
function clearFilters(){
  document.getElementById("searchInput").value = "";
  categoryFilter.value = "";
  sideCategory.value = "";
  filterScripts();
}

/* no results helper */
function showNoResults(show){
  let el = document.getElementById("noResults");
  if(show){
    if(!el){
      el = document.createElement("p");
      el.id = "noResults";
      el.style.color = "#aaa";
      el.style.textAlign = "center";
      el.textContent = "üòî No scripts found...";
      cardList.appendChild(el);
    }
  } else {
    if(el) el.remove();
  }
}

/* -------------------------
   Action handling + popup service selector
------------------------- */

const overlay = document.getElementById("overlay");

function escapeHtml(s){ return String(s).replace(/[&<>"']/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c])); }

function openGame(linkOrId){
  if(!linkOrId) return;
  try{
    if(/^\d+$/.test(linkOrId)) window.open(`https://www.roblox.com/games/${linkOrId}`, "_blank");
    else window.open(decodeURIComponent(linkOrId), "_blank");
  }catch(e){ console.warn(e) }
}

/* main entry: Raw/Copy/Download */
function handleAction(action, id, btnEl){
  const data = scriptsData.find(x=>x.id===id);
  if(!data) return alert("Script not found");
  // show service selector popup
  showServiceSelectionPopup(data, action, btnEl);
}

/* Show popup; user chooses service (linkvertise/lootlabs etc) */
function showServiceSelectionPopup(data, action, btnEl){
  removeOverlay();
  const ov = document.createElement("div");
  ov.className = "overlay";
  ov.id = "lanhub-overlay";
  ov.innerHTML = `
    <div class="popup" role="dialog" aria-modal="true">
      <h4>Select service for: ${escapeHtml(data.name)}</h4>
      <div class="small-note">Choose a service to unlock the script. (demo uses preconfigured direct links)</div>
      <div class="svc-buttons">
        <div class="svc" data-svc="linkvertise">Linkvertise</div>
        <div class="svc" data-svc="lootlabs">LootLabs</div>
        <div class="svc" data-svc="direct">Direct (no unlock)</div>
      </div>
      <div style="display:flex;gap:8px;margin-top:12px;justify-content:flex-end">
        <button class="btn secondary" id="cancelPopup">Cancel</button>
      </div>
    </div>
  `;
  document.body.appendChild(ov);

  // attach handlers
  ov.querySelectorAll(".svc").forEach(el=>{
    el.addEventListener("click",()=>{
      const svc = el.getAttribute("data-svc");
      generateLinkAndProceed(data, svc, action, btnEl);
    });
  });
  ov.querySelector("#cancelPopup").addEventListener("click", removeOverlay);
  // close when clicking outside
  ov.addEventListener("click", (e)=>{ if(e.target===ov) removeOverlay(); });
}

/* Remove overlay */
function removeOverlay(){
  const ex = document.getElementById("lanhub-overlay");
  if(ex) ex.remove();
}

/* generate link (client-side demo) and proceed */
function generateLinkAndProceed(data, service, action, btnEl){
  // show small transition on btn
  if(btnEl){
    const original = btnEl.textContent;
    btnEl.textContent = "Opening...";
    setTimeout(()=> btnEl.textContent = original, 1500);
  }

  // Determine URL:
  // - If script has explicit serviceLinks[service], use it
  // - Else fallback to direct link (we'll craft a small encode)
  let finalUrl = null;
  if(data.serviceLinks && data.serviceLinks[service]) finalUrl = data.serviceLinks[service];
  else if(service === "direct") {
    // show raw directly in new window (no redirect)
    finalUrl = null;
  } else {
    // fallback construct (demo)
    finalUrl = `https://direct-link.net/fallback/${encodeURIComponent(data.id)}?svc=${service}`;
  }

  // Simulate server delay and redirect:
  removeOverlay();
  // If there is a finalUrl, open it in new tab to simulate "unlock flow"
  if(finalUrl){
    // open in new tab then after a short delay open raw/download/copy result
    window.open(finalUrl, "_blank");
    setTimeout(()=> proceedAfterUnlock(data, action), 900); // after user comes back
  } else {
    // direct: proceed immediately
    proceedAfterUnlock(data, action);
  }
}

/* After unlock flow, perform action: raw / copy / download */
function proceedAfterUnlock(data, action){
  if(action === "raw"){
    openRawViewer(data);
  } else if(action === "copy"){
    navigator.clipboard.writeText(data.script || "");
    showToast("‚úÖ Script copied to clipboard");
  } else if(action === "download"){
    const blob = new Blob([data.script || ""], {type:"text/plain"});
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = `${data.name.replace(/\s+/g,"_")}.txt`;
    a.click();
    showToast("‚¨áÔ∏è Download started");
  }
}

/* Raw viewer (new window modal) */
function openRawViewer(data){
  const w = window.open("", "_blank");
  const safeScript = escapeHtml(data.script || "");
  w.document.write(`
    <!doctype html>
    <html>
    <head>
      <meta charset="utf-8"/>
      <title>Raw - ${safeScript && data.name ? escapeHtml(data.name) : "script"}</title>
      <style>body{background:#040014;color:#fff;font-family:monospace;padding:18px}pre{white-space:pre-wrap;word-break:break-word;background:#120021;padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.03)}</style>
    </head>
    <body>
      <h2 style="color:${"#c293ff"}">${escapeHtml(data.name)}</h2>
      <div style="font-size:13px;color:#bbb">Created: ${escapeHtml(data.created)} | Category: ${escapeHtml(data.category||"")}</div>
      <hr style="margin:10px 0 14px 0;border:none;border-top:1px solid rgba(255,255,255,0.03)"/>
      <pre>${safeScript}</pre>
    </body>
    </html>
  `);
}

/* Simple toast */
function showToast(text){
  const t = document.createElement("div");
  t.style.position="fixed";t.style.right="18px";t.style.bottom="18px";t.style.background="rgba(0,0,0,0.6)";
  t.style.color="#fff";t.style.padding="10px 14px";t.style.borderRadius="10px";t.style.zIndex=99999;
  t.textContent = text;
  document.body.appendChild(t);
  setTimeout(()=>{ t.style.transition="all .25s"; t.style.opacity=0; setTimeout(()=>t.remove(),250) }, 1500);
}

/* ----- bulk actions (demo) ----- */
function openAllRaw(){
  scriptsData.forEach(d=> openRawViewer(d));
}
function downloadAll(){
  alert("Demo: download all not implemented (server zip recommended).");
}

/* prefill search / category */
document.getElementById("searchInput").addEventListener("keydown", (e)=>{
  if(e.key === "Escape") { e.target.value=""; filterScripts(); }
});

/* initial render */
renderCards();
filterScripts();

</script>
</body>
  </html>
